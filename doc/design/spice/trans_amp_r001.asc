Version 4
SHEET 1 948 680
WIRE -1648 48 -1696 48
WIRE -1600 48 -1648 48
WIRE -1488 48 -1520 48
WIRE -1328 48 -1488 48
WIRE -1648 144 -1648 48
WIRE -1600 144 -1648 144
WIRE -1488 144 -1488 48
WIRE -1488 144 -1536 144
WIRE -1872 256 -1872 240
WIRE -1696 256 -1696 48
WIRE -1600 256 -1696 256
WIRE -1472 256 -1536 256
WIRE -1872 352 -1872 336
WIRE -1568 416 -1568 368
WIRE -1696 432 -1696 256
WIRE -1696 432 -1968 432
WIRE -1600 432 -1696 432
WIRE -1472 448 -1472 256
WIRE -1472 448 -1536 448
WIRE -1440 448 -1472 448
WIRE -1328 448 -1328 48
WIRE -1328 448 -1360 448
WIRE -1232 448 -1328 448
WIRE -1104 448 -1232 448
WIRE -1024 448 -1104 448
WIRE -1600 464 -1696 464
WIRE -1232 480 -1232 448
WIRE -1104 480 -1104 448
WIRE -1872 560 -1872 528
WIRE -1776 560 -1776 528
WIRE -1696 560 -1696 464
WIRE -1568 560 -1568 480
WIRE -1232 576 -1232 544
WIRE -1104 576 -1104 560
FLAG -1872 352 0
FLAG -1872 240 Vcc
FLAG -1568 368 Vcc
FLAG -1568 560 0
FLAG -1232 576 0
FLAG -1696 560 0
FLAG -1776 560 0
FLAG -1872 560 0
FLAG -1104 576 0
FLAG -1968 432 Vin
IOPIN -1968 432 In
FLAG -1024 448 Vout
IOPIN -1024 448 Out
SYMBOL voltage -1872 240 M0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V2
SYMATTR Value {V_CC}
SYMBOL res -1616 64 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName Rf
SYMATTR Value 10k
SYMBOL cap -1600 160 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName Cstray
SYMATTR Value 0.2p
SYMBOL OPA380 -1568 384 R0
SYMATTR InstName U1
SYMBOL res -1456 464 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName Rfilter
SYMATTR Value 100
SYMBOL cap -1248 480 R0
SYMATTR InstName Cfilter
SYMATTR Value .1n
SYMBOL cap -1600 272 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName Cf
SYMATTR Value 2p
SYMBOL cap -1888 464 R0
SYMATTR InstName C_CM
SYMATTR Value 3p
SYMBOL cap -1792 464 R0
SYMATTR InstName C_DM
SYMATTR Value 1.1p
SYMBOL res -1120 464 R0
SYMATTR InstName Rload
SYMATTR Value 2k
TEXT -1224 -120 Left 2 ;OPA380 GBW of 90MHz\ntypical stray cap of surface mount resistor is C_STRAY=0.2pF\nC_TOT = C_DIODE + C_PARASITIC_CM + C_PARASITIC_DM\nC_TOT = 10pF + 3pF + 1.1pF\n \nWith R_F of 2k, we need C_F to be ~2pF to achieve the relation:\n1 / ( 2*pi*R_F*(C_F+C_STRAY) ) = sqrt( GBW / ( 4*pi*R_F*(C_TOT) ) )\nor C_F = 1 / ( sqrt(pi)*R_F*sqrt(GBW/(R_F*C_TOT)) ) - C_STRAY\nC_F = 1 / ( sqrt(pi)*10e3*sqrt(90e6/(10e3*(10e-12+3e-12+1.1e-12))) ) - 0.2e-12 = 2.03pF\n \nBW is calculated by:\nf_3dB = sqrt( GBW / ( 2*pi*R_F*(C_TOT) ) )\nf_3dB = sqrt( 90e6 / (2*pi*10e3*(10e-12+3e-12+1.1e-12)) ) = 10.08MHz\n \nSelect filter values for 2nd pole for maximally flat passband (2-pole Butterworth filter) so that:\nC_F*R_F = 2*C_FILTER*R_FILTER\nor C_FILTER = (C_F*R_F) / (2*R_FILTER)\nC_FILTER = (2.03e-12*10e3) / (2*100) = 101.5pF = 0.1nF
TEXT -1696 -192 Left 3 ;Transimpedance Amplifier
TEXT -1696 -120 Left 2 ;.param V_CC = 5
TEXT -1696 -160 Left 2 ;_
